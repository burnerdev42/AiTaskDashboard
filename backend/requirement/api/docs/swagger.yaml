openapi: 3.0.0
info:
  title: AI Task Dashboard API
  description: >
    Automatically derived CRUD API documentation based on `Data requirements.md`.
    All responses follow the standardized API response envelope.
  version: 1.1.0
servers:
  - url: /api/v1
    description: Main API Server

tags:
  - name: Auth
  - name: Users
  - name: Challenges
  - name: Ideas
  - name: Comments
  - name: Activities
  - name: Notifications

paths:
  # ==============================
  # AUTH ENDPOINTS
  # ==============================
  /auth/register:
    post:
      tags: [Auth]
      summary: Register a new user
      description: Creates a new user profile and securely hashes the password.
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UserBase'
      responses:
        '201':
          description: User registered successfully
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/ApiResponseEnvelope'
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          user:
                            $ref: '#/components/schemas/UserResponse'
        '409':
          description: Conflict - Email already exists
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ApiResponseEnvelope'

  /auth/login:
    post:
      tags: [Auth]
      summary: Authenticate a user
      description: Verifies user credentials and returns an auth token/session.
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/AuthLoginRequest'
      responses:
        '200':
          description: Authentication successful
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/ApiResponseEnvelope'
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          token:
                            type: string
                            description: JWT Access Token
                          user:
                            $ref: '#/components/schemas/UserResponse'
        '401':
          description: Unauthorized - Invalid credentials
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ApiResponseEnvelope'

  # ==============================
  # USERS ENDPOINTS
  # ==============================
  /users:
    get:
      tags: [Users]
      summary: Get all users
      parameters:
        - $ref: '#/components/parameters/LimitParam'
        - $ref: '#/components/parameters/OffsetParam'
      responses:
        '200':
          description: A list of users including derived fields
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/ApiResponseEnvelope'
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          users:
                            type: array
                            items:
                              $ref: '#/components/schemas/UserResponse'
    post:
      tags: [Users]
      summary: Create a user
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UserBase'
      responses:
        '201':
          description: User created
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/ApiResponseEnvelope'
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          user:
                            $ref: '#/components/schemas/UserResponse'

  /users/count:
    get:
      tags: [Users]
      operationId: getUserCount
      summary: Get user count
      responses:
        '200':
          description: Total count
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CountApiResponse'
        '400':
          description: Bad request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ApiResponseEnvelope'

  /users/count-by-role:
    get:
      tags: [Users]
      summary: Get user count grouped by role
      operationId: getUserCountByRole
      responses:
        '200':
          description: User count by role
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/ApiResponseEnvelope'
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          ADMIN:
                            type: integer
                          MEMBER:
                            type: integer
                          USER:
                            type: integer
        '400':
          description: Bad request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ApiResponseEnvelope'

  /users/{id}:
    get:
      tags: [Users]
      summary: Get user by MongoDB _id
      parameters:
        - $ref: '#/components/parameters/MongoIdParam'
      responses:
        '200':
          description: User object with derived fields
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/ApiResponseEnvelope'
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          user:
                            $ref: '#/components/schemas/UserResponse'
    put:
      tags: [Users]
      summary: Update a user
      parameters:
        - $ref: '#/components/parameters/MongoIdParam'
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UserBase'
      responses:
        '200':
          description: User updated
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/ApiResponseEnvelope'
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          user:
                            $ref: '#/components/schemas/UserResponse'
    delete:
      tags: [Users]
      summary: Delete a user
      parameters:
        - $ref: '#/components/parameters/MongoIdParam'
      responses:
        '204':
          description: User deleted

  # ==============================
  # CHALLENGES ENDPOINTS
  # ==============================
  /challenges:
    get:
      tags: [Challenges]
      summary: Get all challenges
      parameters:
        - $ref: '#/components/parameters/LimitParam'
        - $ref: '#/components/parameters/OffsetParam'
      responses:
        '200':
          description: A list of challenges including derived fields
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/ApiResponseEnvelope'
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          challenges:
                            type: array
                            items:
                              $ref: '#/components/schemas/ChallengeResponse'
    post:
      tags: [Challenges]
      summary: Create a challenge
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ChallengeBase'
      responses:
        '201':
          description: Challenge created
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/ApiResponseEnvelope'
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          challenge:
                            $ref: '#/components/schemas/ChallengeResponse'

  /challenges/count:
    get:
      tags: [Challenges]
      summary: Get challenge count
      responses:
        '200':
          description: Total count
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CountApiResponse'

  /challenges/{virtualId}:
    get:
      tags: [Challenges]
      summary: Get challenge by Virtual ID (e.g., CH-001)
      parameters:
        - name: virtualId
          in: path
          required: true
          schema:
            type: string
          description: The virtual ID of the challenge
      responses:
        '200':
          description: Challenge object with derived fields
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/ApiResponseEnvelope'
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          challenge:
                            $ref: '#/components/schemas/ChallengeResponse'
    put:
      tags: [Challenges]
      summary: Update a challenge
      parameters:
        - name: virtualId
          in: path
          required: true
          schema:
            type: string
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ChallengeBase'
      responses:
        '200':
          description: Challenge updated
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/ApiResponseEnvelope'
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          challenge:
                            $ref: '#/components/schemas/ChallengeResponse'
    patch:
      tags: [Challenges]
      summary: Update challenge status (Swim Lane)
      parameters:
        - name: virtualId
          in: path
          required: true
          schema:
            type: string
      description: >
        Update the swim lane status of a challenge.
        **Constraint:** Once a challenge is in `pilot` status it cannot be moved back to `submitted`.
      requestBody:
        content:
          application/json:
            schema:
              type: object
              required: [status]
              properties:
                status:
                  type: string
                  enum: [submitted, ideation, pilot, completed, archive]
                  description: New swim lane status. Transition from 'pilot' back to 'submitted' is forbidden.
      responses:
        '200':
          description: Challenge status updated successfully
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/ApiResponseEnvelope'
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          challenge:
                            $ref: '#/components/schemas/ChallengeResponse'
        '400':
          description: Bad Request - Invalid status transition (e.g., pilot to submitted is not allowed)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ApiResponseEnvelope'
    delete:
      tags: [Challenges]
      summary: Delete a challenge
      parameters:
        - name: virtualId
          in: path
          required: true
          schema:
            type: string
      responses:
        '204':
          description: Challenge deleted

  /challenges/{virtualId}/upvote:
    post:
      tags: [Challenges]
      summary: Toggle upvote for a challenge
      operationId: toggleChallengeUpvote
      parameters:
        - name: virtualId
          in: path
          required: true
          schema:
            type: string
          description: The virtual ID of the challenge
      requestBody:
        content:
          application/json:
            schema:
              type: object
              required: [userId]
              properties:
                userId:
                  type: string
      responses:
        '200':
          description: Upvote toggled successfully
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/ApiResponseEnvelope'
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          challenge:
                            $ref: '#/components/schemas/ChallengeResponse'
        '404':
          description: Challenge not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ApiResponseEnvelope'

  /challenges/{virtualId}/subscribe:
    post:
      tags: [Challenges]
      summary: Toggle subscription for a challenge
      operationId: toggleChallengeSubscribe
      parameters:
        - name: virtualId
          in: path
          required: true
          schema:
            type: string
          description: The virtual ID of the challenge
      requestBody:
        content:
          application/json:
            schema:
              type: object
              required: [userId]
              properties:
                userId:
                  type: string
      responses:
        '200':
          description: Subscription toggled successfully
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/ApiResponseEnvelope'
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          challenge:
                            $ref: '#/components/schemas/ChallengeResponse'
        '404':
          description: Challenge not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ApiResponseEnvelope'

  /challenges/{virtualId}/view:
    post:
      tags: [Challenges]
      summary: Increment view count for a challenge
      operationId: incrementChallengeView
      parameters:
        - name: virtualId
          in: path
          required: true
          schema:
            type: string
          description: The virtual ID of the challenge
      responses:
        '200':
          description: View count incremented successfully
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/ApiResponseEnvelope'
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          challenge:
                            $ref: '#/components/schemas/ChallengeResponse'
        '404':
          description: Challenge not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ApiResponseEnvelope'

  # ==============================
  # IDEAS ENDPOINTS
  # ==============================
  /ideas:
    get:
      tags: [Ideas]
      summary: Get all ideas
      parameters:
        - $ref: '#/components/parameters/LimitParam'
        - $ref: '#/components/parameters/OffsetParam'
      responses:
        '200':
          description: A list of ideas including derived fields
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/ApiResponseEnvelope'
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          ideas:
                            type: array
                            items:
                              $ref: '#/components/schemas/IdeaResponse'
    post:
      tags: [Ideas]
      summary: Create an idea
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/IdeaBase'
      responses:
        '201':
          description: Idea created
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/ApiResponseEnvelope'
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          idea:
                            $ref: '#/components/schemas/IdeaResponse'

  /ideas/count:
    get:
      tags: [Ideas]
      summary: Get ideas count
      responses:
        '200':
          description: Total count
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CountApiResponse'

  /ideas/challenge/{virtualId}:
    get:
      tags: [Ideas]
      summary: Get ideas for a challenge by challenge virtualId
      operationId: getIdeasByChallengeVirtualId
      description: >
        Fetches all ideas linked to a challenge. Internally resolves the challenge
        by virtualId and queries ideas where challengeId matches the challenge's
        MongoDB _id. Returns enriched ideas with derived fields.
      parameters:
        - name: virtualId
          in: path
          required: true
          schema:
            type: string
          description: The virtual ID of the challenge (e.g., CH-001)
      responses:
        '200':
          description: List of ideas for the challenge
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/ApiResponseEnvelope'
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          ideas:
                            type: array
                            items:
                              $ref: '#/components/schemas/IdeaResponse'
        '404':
          description: Challenge not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ApiResponseEnvelope'

  /ideas/{virtualId}:
    get:
      tags: [Ideas]
      summary: Get idea by Virtual ID (e.g., ID-0001)
      parameters:
        - name: virtualId
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Idea object with derived fields
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/ApiResponseEnvelope'
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          idea:
                            $ref: '#/components/schemas/IdeaResponse'
    put:
      tags: [Ideas]
      summary: Update an idea
      parameters:
        - name: virtualId
          in: path
          required: true
          schema:
            type: string
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/IdeaBase'
      responses:
        '200':
          description: Idea updated
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/ApiResponseEnvelope'
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          idea:
                            $ref: '#/components/schemas/IdeaResponse'
    delete:
      tags: [Ideas]
      summary: Delete an idea
      parameters:
        - name: virtualId
          in: path
          required: true
          schema:
            type: string
      responses:
        '204':
          description: Idea deleted

  /ideas/{virtualId}/upvote:
    post:
      tags: [Ideas]
      summary: Toggle upvote for an idea
      operationId: toggleIdeaUpvote
      parameters:
        - name: virtualId
          in: path
          required: true
          schema:
            type: string
          description: The virtual/idea ID of the idea
      requestBody:
        content:
          application/json:
            schema:
              type: object
              required: [userId]
              properties:
                userId:
                  type: string
      responses:
        '200':
          description: Upvote toggled successfully
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/ApiResponseEnvelope'
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          idea:
                            $ref: '#/components/schemas/IdeaResponse'
        '404':
          description: Idea not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ApiResponseEnvelope'

  /ideas/{virtualId}/subscribe:
    post:
      tags: [Ideas]
      summary: Toggle subscription for an idea
      operationId: toggleIdeaSubscribe
      parameters:
        - name: virtualId
          in: path
          required: true
          schema:
            type: string
          description: The virtual/idea ID of the idea
      requestBody:
        content:
          application/json:
            schema:
              type: object
              required: [userId]
              properties:
                userId:
                  type: string
      responses:
        '200':
          description: Subscription toggled successfully
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/ApiResponseEnvelope'
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          idea:
                            $ref: '#/components/schemas/IdeaResponse'
        '404':
          description: Idea not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ApiResponseEnvelope'

  /ideas/{virtualId}/view:
    post:
      tags: [Ideas]
      summary: Increment view count for an idea
      operationId: incrementIdeaView
      parameters:
        - name: virtualId
          in: path
          required: true
          schema:
            type: string
          description: The virtual/idea ID of the idea
      responses:
        '200':
          description: View count incremented successfully
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/ApiResponseEnvelope'
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          idea:
                            $ref: '#/components/schemas/IdeaResponse'
        '404':
          description: Idea not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ApiResponseEnvelope'

  # ==============================
  # COMMENTS ENDPOINTS
  # ==============================
  /comments:
    get:
      tags: [Comments]
      summary: Get all comments
      parameters:
        - $ref: '#/components/parameters/LimitParam'
        - $ref: '#/components/parameters/OffsetParam'
      responses:
        '200':
          description: A list of comments including derived fields
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/ApiResponseEnvelope'
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          comments:
                            type: array
                            items:
                              $ref: '#/components/schemas/CommentResponse'
    post:
      tags: [Comments]
      summary: Create a comment
      description: >
        Creates a new comment. The `type` field is derived from the virtualId prefix
        (CH- = Challenge, ID- = Idea) and maps to Comment Types ["CH", "ID"].
        Auto-subscribes the commenter to the parent entity.
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CommentBase'
      responses:
        '201':
          description: Comment created
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/ApiResponseEnvelope'
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          comment:
                            $ref: '#/components/schemas/CommentResponse'

  /comments/count:
    get:
      tags: [Comments]
      summary: Get total comments count
      responses:
        '200':
          description: Total comment count
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CountApiResponse'

  /comments/{id}:
    get:
      tags: [Comments]
      summary: Get comment by MongoDB _id
      parameters:
        - $ref: '#/components/parameters/MongoIdParam'
      responses:
        '200':
          description: Comment object with derived fields
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/ApiResponseEnvelope'
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          comment:
                            $ref: '#/components/schemas/CommentResponse'
    put:
      tags: [Comments]
      summary: Update a comment
      parameters:
        - $ref: '#/components/parameters/MongoIdParam'
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CommentBase'
      responses:
        '200':
          description: Comment updated
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/ApiResponseEnvelope'
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          comment:
                            $ref: '#/components/schemas/CommentResponse'
    delete:
      tags: [Comments]
      summary: Delete a comment
      parameters:
        - $ref: '#/components/parameters/MongoIdParam'
      responses:
        '204':
          description: Comment deleted

  /comments/challenge/{virtualId}:
    get:
      tags: [Comments]
      summary: Get comments for a challenge by virtualId
      operationId: getCommentsByChallengeVirtualId
      description: >
        Fetches all comments for a challenge. The virtualId prefix (CH-) maps to
        Comment Type "CH". Internally resolves the challenge by virtualId and
        queries comments where type="CH" and typeId matches.
      parameters:
        - name: virtualId
          in: path
          required: true
          schema:
            type: string
          description: The virtual ID of the challenge (e.g., CH-001)
      responses:
        '200':
          description: List of comments for the challenge
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/ApiResponseEnvelope'
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          comments:
                            type: array
                            items:
                              $ref: '#/components/schemas/CommentResponse'
        '404':
          description: Challenge not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ApiResponseEnvelope'

  /comments/challenge/{virtualId}/count:
    get:
      tags: [Comments]
      summary: Get comment count for a challenge by virtualId
      operationId: getCommentCountByChallengeVirtualId
      parameters:
        - name: virtualId
          in: path
          required: true
          schema:
            type: string
          description: The virtual ID of the challenge (e.g., CH-001)
      responses:
        '200':
          description: Comment count for the challenge
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CountApiResponse'
        '404':
          description: Challenge not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ApiResponseEnvelope'

  /comments/idea/{virtualId}:
    get:
      tags: [Comments]
      summary: Get comments for an idea by virtualId
      operationId: getCommentsByIdeaVirtualId
      description: >
        Fetches all comments for an idea. The virtualId prefix (ID-) maps to
        Comment Type "ID". Internally resolves the idea by virtualId and
        queries comments where type="ID" and typeId matches.
      parameters:
        - name: virtualId
          in: path
          required: true
          schema:
            type: string
          description: The virtual ID of the idea (e.g., ID-0001)
      responses:
        '200':
          description: List of comments for the idea
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/ApiResponseEnvelope'
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          comments:
                            type: array
                            items:
                              $ref: '#/components/schemas/CommentResponse'
        '404':
          description: Idea not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ApiResponseEnvelope'

  /comments/idea/{virtualId}/count:
    get:
      tags: [Comments]
      summary: Get comment count for an idea by virtualId
      operationId: getCommentCountByIdeaVirtualId
      parameters:
        - name: virtualId
          in: path
          required: true
          schema:
            type: string
          description: The virtual ID of the idea (e.g., ID-0001)
      responses:
        '200':
          description: Comment count for the idea
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CountApiResponse'
        '404':
          description: Idea not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ApiResponseEnvelope'

  /comments/user/{userId}:
    get:
      tags: [Comments]
      summary: Get comments by user ID
      operationId: getCommentsByUserId
      parameters:
        - name: userId
          in: path
          required: true
          schema:
            type: string
          description: 24-character hexadecimal MongoDB User ID
        - $ref: '#/components/parameters/LimitParam'
        - $ref: '#/components/parameters/OffsetParam'
      responses:
        '200':
          description: List of comments by the specified user
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/ApiResponseEnvelope'
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          comments:
                            type: array
                            items:
                              $ref: '#/components/schemas/CommentResponse'
        '404':
          description: User not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ApiResponseEnvelope'

  /comments/user/{userId}/count:
    get:
      tags: [Comments]
      summary: Get comment count for a user
      operationId: getCommentCountByUserId
      parameters:
        - name: userId
          in: path
          required: true
          schema:
            type: string
          description: 24-character hexadecimal MongoDB User ID
      responses:
        '200':
          description: Comment count for the user
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CountApiResponse'
        '404':
          description: User not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ApiResponseEnvelope'

  # ==============================
  # ACTIVITIES ENDPOINTS
  # ==============================
  /activities:
    get:
      tags: [Activities]
      summary: Get all activities
      description: Highly dynamic list, heavily utilizes pagination limits and offsets.
      parameters:
        - $ref: '#/components/parameters/LimitParam'
        - $ref: '#/components/parameters/OffsetParam'
      responses:
        '200':
          description: A list of activities including contextual derived fields
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/ApiResponseEnvelope'
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          activities:
                            type: array
                            items:
                              $ref: '#/components/schemas/ActivityResponse'
    post:
      tags: [Activities]
      summary: Create an activity
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ActivityBase'
      responses:
        '201':
          description: Activity created
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/ApiResponseEnvelope'
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          activity:
                            $ref: '#/components/schemas/ActivityResponse'

  /activities/count:
    get:
      tags: [Activities]
      summary: Get activities count
      responses:
        '200':
          description: Total count
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CountApiResponse'

  /activities/{id}:
    get:
      tags: [Activities]
      summary: Get activity by MongoDB _id
      parameters:
        - $ref: '#/components/parameters/MongoIdParam'
      responses:
        '200':
          description: Activity object with derived fields
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/ApiResponseEnvelope'
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          activity:
                            $ref: '#/components/schemas/ActivityResponse'
    put:
      tags: [Activities]
      summary: Update an activity
      parameters:
        - $ref: '#/components/parameters/MongoIdParam'
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ActivityBase'
      responses:
        '200':
          description: Activity updated
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/ApiResponseEnvelope'
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          activity:
                            $ref: '#/components/schemas/ActivityResponse'
    delete:
      tags: [Activities]
      summary: Delete an activity
      parameters:
        - $ref: '#/components/parameters/MongoIdParam'
      responses:
        '204':
          description: Activity deleted

  /activities/user/{userId}:
    get:
      tags: [Activities]
      summary: Get activities by user ID
      operationId: getActivitiesByUserId
      parameters:
        - name: userId
          in: path
          required: true
          schema:
            type: string
          description: 24-character hexadecimal MongoDB User ID
        - $ref: '#/components/parameters/LimitParam'
        - $ref: '#/components/parameters/OffsetParam'
      responses:
        '200':
          description: A list of activities for the specified user
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/ApiResponseEnvelope'
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          activities:
                            type: array
                            items:
                              $ref: '#/components/schemas/ActivityResponse'
        '404':
          description: User not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ApiResponseEnvelope'

  /activities/user/{userId}/count:
    get:
      tags: [Activities]
      summary: Get total activity count for a user
      operationId: getActivityCountByUserId
      parameters:
        - name: userId
          in: path
          required: true
          schema:
            type: string
          description: 24-character hexadecimal MongoDB User ID
      responses:
        '200':
          description: Total activity count for the user
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CountApiResponse'
        '404':
          description: User not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ApiResponseEnvelope'

  # ==============================
  # NOTIFICATIONS ENDPOINTS
  # ==============================
  /notifications:
    get:
      tags: [Notifications]
      summary: Get all notifications for user
      description: Notification stream requiring strict pagination with limits and offsets.
      parameters:
        - $ref: '#/components/parameters/LimitParam'
        - $ref: '#/components/parameters/OffsetParam'
      responses:
        '200':
          description: A list of notifications including contextual derived fields
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/ApiResponseEnvelope'
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          notifications:
                            type: array
                            items:
                              $ref: '#/components/schemas/NotificationResponse'
    post:
      tags: [Notifications]
      summary: Create a notification
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/NotificationBase'
      responses:
        '201':
          description: Notification created
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/ApiResponseEnvelope'
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          notification:
                            $ref: '#/components/schemas/NotificationResponse'

  /notifications/count:
    get:
      tags: [Notifications]
      summary: Get notifications count
      responses:
        '200':
          description: Total count
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CountApiResponse'

  /notifications/{id}:
    get:
      tags: [Notifications]
      summary: Get notification by MongoDB _id
      parameters:
        - $ref: '#/components/parameters/MongoIdParam'
      responses:
        '200':
          description: Notification object with derived fields
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/ApiResponseEnvelope'
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          notification:
                            $ref: '#/components/schemas/NotificationResponse'
    put:
      tags: [Notifications]
      summary: Update a notification (e.g., mark as read/isSeen)
      parameters:
        - $ref: '#/components/parameters/MongoIdParam'
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/NotificationBase'
      responses:
        '200':
          description: Notification updated
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/ApiResponseEnvelope'
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          notification:
                            $ref: '#/components/schemas/NotificationResponse'
    patch:
      tags: [Notifications]
      summary: Update notification status (isSeen)
      parameters:
        - $ref: '#/components/parameters/MongoIdParam'
      requestBody:
        content:
          application/json:
            schema:
              type: object
              required: [isSeen]
              properties:
                isSeen:
                  type: boolean
                  description: Mark notification as seen or unseen
      responses:
        '200':
          description: Notification status updated successfully
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/ApiResponseEnvelope'
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          notification:
                            $ref: '#/components/schemas/NotificationResponse'
    delete:
      tags: [Notifications]
      summary: Delete a notification
      parameters:
        - $ref: '#/components/parameters/MongoIdParam'
      responses:
        '204':
          description: Notification deleted

  /notifications/user/{userId}:
    get:
      tags: [Notifications]
      summary: Get notifications by user ID
      operationId: getNotificationsByUserId
      parameters:
        - name: userId
          in: path
          required: true
          schema:
            type: string
          description: 24-character hexadecimal MongoDB User ID (recipient)
        - $ref: '#/components/parameters/LimitParam'
        - $ref: '#/components/parameters/OffsetParam'
      responses:
        '200':
          description: A list of notifications for the specified user
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/ApiResponseEnvelope'
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          notifications:
                            type: array
                            items:
                              $ref: '#/components/schemas/NotificationResponse'
        '404':
          description: User not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ApiResponseEnvelope'

  /notifications/user/{userId}/count:
    get:
      tags: [Notifications]
      summary: Get notification count for a user
      operationId: getNotificationCountByUserId
      parameters:
        - name: userId
          in: path
          required: true
          schema:
            type: string
          description: 24-character hexadecimal MongoDB User ID (recipient)
        - name: isSeen
          in: query
          required: false
          schema:
            type: boolean
          description: Filter by seen status. If omitted, returns count of all notifications.
      responses:
        '200':
          description: Notification count (filtered or total)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CountApiResponse'
        '404':
          description: User not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ApiResponseEnvelope'

  # ==============================
  # METRICS ENDPOINTS
  # ==============================
  /metrics/summary:
    get:
      tags: [Metrics]
      summary: Get top metric summary
      operationId: getMetricSummary
      responses:
        '200':
          description: Top metric summary data
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/ApiResponseEnvelope'
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          totalChallenges:
                            type: integer
                          totalIdeas:
                            type: integer
                          conversionRate:
                            type: number
                          targetConversionRate:
                            type: number
                          averageTimeToPilot:
                            type: number
                          activeContributions:
                            type: integer
                          totalUsers:
                            type: integer
        '400':
          description: Bad request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ApiResponseEnvelope'

  /metrics/funnel:
    get:
      tags: [Metrics]
      summary: Get innovation funnel metrics
      operationId: getInnovationFunnelMetrics
      responses:
        '200':
          description: Innovation funnel data
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/ApiResponseEnvelope'
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          totalChallenges:
                            type: integer
                          totalIdeas:
                            type: integer
                          challengesBySwimLane:
                            type: object
                            additionalProperties:
                              type: integer
                          conversionRate:
                            type: number
                          targetConversionRate:
                            type: number
        '400':
          description: Bad request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ApiResponseEnvelope'

  /metrics/team-engagement:
    get:
      tags: [Metrics]
      summary: Get team engagement metrics
      operationId: getTeamEngagementMetrics
      responses:
        '200':
          description: Team engagement data
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/ApiResponseEnvelope'
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          challengesByPlatform:
                            type: object
                            additionalProperties:
                              type: integer
        '400':
          description: Bad request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ApiResponseEnvelope'

  /metrics/portfolio-balance:
    get:
      tags: [Metrics]
      summary: Get portfolio balance metrics
      operationId: getPortfolioBalanceMetrics
      responses:
        '200':
          description: Portfolio balance data
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/ApiResponseEnvelope'
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          challengesByPortfolioLane:
                            type: object
                            additionalProperties:
                              type: integer
        '400':
          description: Bad request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ApiResponseEnvelope'

  /metrics/innovation-velocity:
    get:
      tags: [Metrics]
      summary: Get innovation velocity metrics
      operationId: getInnovationVelocityMetrics
      responses:
        '200':
          description: Innovation velocity data
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/ApiResponseEnvelope'
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          data:
                            type: array
                            items:
                              type: object
                              properties:
                                month:
                                  type: integer
                                year:
                                  type: integer
                                challenges:
                                  type: integer
                                ideas:
                                  type: integer
        '400':
          description: Bad request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ApiResponseEnvelope'

  /metrics/opco-radar:
    get:
      tags: [Metrics]
      summary: Get opco radar metrics
      operationId: getOpcoRadarMetrics
      responses:
        '200':
          description: Opco radar data
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/ApiResponseEnvelope'
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          challengesByOpco:
                            type: object
                            additionalProperties:
                              type: integer
        '400':
          description: Bad request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ApiResponseEnvelope'

  # ==============================
  # HOME ENDPOINTS
  # ==============================
  /home/top-challenges:
    get:
      tags: [Home]
      summary: Get top 5 challenges
      operationId: getHomeTopChallenges
      responses:
        '200':
          description: Top 5 challenges
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/ApiResponseEnvelope'
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          challenges:
                            type: array
                            items:
                              $ref: '#/components/schemas/ChallengeResponse'
        '400':
          description: Bad request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ApiResponseEnvelope'

  /home/status-distribution:
    get:
      tags: [Home]
      summary: Get challenge count by status
      operationId: getHomeStatusDistribution
      responses:
        '200':
          description: Challenge count by status
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/ApiResponseEnvelope'
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          challengesByStatus:
                            type: object
                            additionalProperties:
                              type: integer
        '400':
          description: Bad request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ApiResponseEnvelope'

  /home/key-metrics:
    get:
      tags: [Home]
      summary: Get key metrics summary
      operationId: getHomeKeyMetrics
      responses:
        '200':
          description: Key metrics for home
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/ApiResponseEnvelope'
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          pilotRate:
                            type: number
                          conversionRate:
                            type: number
                          targetConversionRate:
                            type: number
        '400':
          description: Bad request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ApiResponseEnvelope'

  /home/monthly-throughput:
    get:
      tags: [Home]
      summary: Get monthly throughput 
      operationId: getHomeMonthlyThroughput
      responses:
        '200':
          description: Monthly throughput data
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/ApiResponseEnvelope'
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          data:
                            type: array
                            items:
                              type: object
                              properties:
                                month:
                                  type: integer
                                year:
                                  type: integer
                                challenges:
                                  type: integer
                                ideas:
                                  type: integer
        '400':
          description: Bad request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ApiResponseEnvelope'

  /home/innovation-team:
    get:
      tags: [Home]
      summary: Get innovation team members
      operationId: getHomeInnovationTeam
      responses:
        '200':
          description: Innovation team members
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/ApiResponseEnvelope'
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          users:
                            type: array
                            items:
                              $ref: '#/components/schemas/UserResponse'
        '400':
          description: Bad request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ApiResponseEnvelope'

components:
  parameters:
    MongoIdParam:
      name: id
      in: path
      required: true
      schema:
        type: string
      description: 24-character hexadecimal MongoDB Object ID
    LimitParam:
      name: limit
      in: query
      required: false
      schema:
        type: integer
        default: 20
      description: Amount of records to return for pagination
    OffsetParam:
      name: offset
      in: query
      required: false
      schema:
        type: integer
        default: 0
      description: Amount of records to skip for pagination

  schemas:
    # ------------------
    # GLOBAL RESPONSE ENVELOPE
    # ------------------
    ApiResponseEnvelope:
      type: object
      required: [status, message, timestamp]
      properties:
        status:
          type: string
          enum: [success, failed]
          description: Indicates whether the request was successful or failed
        message:
          type: string
          description: Human-readable success or failure message
        timestamp:
          type: string
          format: date-time
          description: ISO 8601 date-time of the response
        data:
          type: object
          nullable: true
          description: Domain-specific payload. May be null on failure.

    CountApiResponse:
      allOf:
        - $ref: '#/components/schemas/ApiResponseEnvelope'
        - type: object
          properties:
            data:
              type: object
              properties:
                count:
                  type: integer
                  description: The total count

    # ------------------
    # MINIMAL SCHEMAS (FOR REUSE)
    # ------------------
    UserMinimal:
      type: object
      required: [_id, name]
      properties:
        _id:
          type: string
          description: MongoDB hex ID
        name:
          type: string
        email:
          type: string
        companyTechRole:
          type: string
        role:
          type: string
          enum: ['ADMIN', 'MEMBER', 'USER']

    ChallengeMinimal:
      type: object
      required: [_id, title]
      properties:
        _id:
          type: string
          description: MongoDB hex ID
        virtualId:
          type: string
          description: CH-XXX format
        title:
          type: string

    IdeaMinimal:
      type: object
      required: [_id, title]
      properties:
        _id:
          type: string
          description: MongoDB hex ID
        ideaId:
          type: string
          description: ID-XXXX format
        title:
          type: string

    CommentMinimal:
      type: object
      properties:
        _id:
          type: string
          description: MongoDB hex ID
        comment:
          type: string
        userId:
          type: string
        createdat:
          type: string
          format: date-time

    # ------------------
    # BASE DB SCHEMAS mapping to input DB fields
    # ------------------
    UserBase:
      type: object
      properties:
        name:
          type: string
        opco:
          type: string
        platform:
          type: string
        companyTechRole:
          type: string
        email:
          type: string
          format: email
        password:
          type: string
          format: password
          description: Required for registration, stripped in responses.
        interestAreas:
          type: array
          items:
            type: string
        role:
          type: string
          enum: ['ADMIN', 'MEMBER', 'USER']
        status:
          type: string
          enum: ['PENDING', 'APPROVED', 'BLOCKED', 'INACTIVE']
        innovationScore:
          type: integer
          minimum: 1
          maximum: 999
        upvotedChallengeList:
          type: array
          items:
            type: string
        upvotedAppreciatedIdeaList:
          type: array
          items:
            type: string

    ChallengeBase:
      type: object
      properties:
        title:
          type: string
        opco:
          type: string
        platform:
          type: string
        description:
          type: string
        summary:
          type: string
        outcome:
          type: string
        timeline:
          type: string
        portfolioLane:
          type: string
        priority:
          type: string
        tags:
          type: array
          items:
            type: string
          default: ["ai"]
        constraint:
          type: string
        stakeHolder:
          type: string
        virtualId:
          type: string
        status:
          type: string
        userId:
          type: string
        month:
          type: integer
        year:
          type: integer
        upVotes:
          type: array
          items:
            type: string
        subcriptions:
          type: array
          items:
            type: string
        viewCount:
          type: integer
        timestampOfStatusChangedToPilot:
          type: string
          format: date-time
          nullable: true
        timestampOfCompleted:
          type: string
          format: date-time
          nullable: true

    IdeaBase:
      type: object
      properties:
        ideaId:
          type: string
        title:
          type: string
        description:
          type: string
        proposedSolution:
          type: string
        challengeId:
          type: string
        appreciationCount:
          type: integer
        viewCount:
          type: integer
        userId:
          type: string
        subscription:
          type: array
          items:
            type: string
        month:
          type: integer
        year:
          type: integer
        status:
          type: boolean
        upVotes:
          type: array
          items:
            type: string

    CommentBase:
      type: object
      properties:
        userId:
          type: string
        comment:
          type: string
        type:
          type: string
          enum: ['CH', 'ID']
        typeId:
          type: string
        createdat:
          type: string
          format: date-time

    ActivityBase:
      type: object
      properties:
        type:
          type: string
          enum:
            - challenge_created
            - idea_created
            - challenge_status_update
            - challenge_edited
            - idea_edited
            - challenge_upvoted
            - idea_upvoted
            - challenge_commented
            - idea_commented
            - challenge_subscribed
            - idea_subscribed
            - challenge_deleted
            - idea_deleted
            - log_in
            - log_out
        fk_id:
          type: string
          nullable: true
        userId:
          type: string
        month:
          type: integer
        year:
          type: integer
        createdAt:
          type: string
          format: date-time

    NotificationBase:
      type: object
      properties:
        type:
          type: string
          enum:
            - challenge_created
            - challenge_status_update
            - challenge_edited
            - idea_edited
            - challenge_upvoted
            - idea_upvoted
            - challenge_commented
            - idea_commented
            - challenge_subscribed
            - idea_subscribed
            - challenge_deleted
            - idea_deleted
        fk_id:
          type: string
          nullable: true
        userId:
          type: string
        initiatorId:
          type: string
          description: Mongo hex ID of the user who triggered the notification
        isSeen:
          type: boolean
          default: false
        createdAt:
          type: string
          format: date-time

    # ------------------
    # RESPONSE SCHEMAS combining Base + Derived Fields
    # ------------------
    UserResponse:
      allOf:
        - $ref: '#/components/schemas/UserBase'
        - type: object
          properties:
            _id:
              type: string
            createdAt:
              type: string
              format: date-time
            updatedAt:
              type: string
              format: date-time
            upvoteCount:
              type: integer
              description: "(DERIVED) Sum of upvotes on challenges and ideas"
            recentActivity:
              type: array
              description: "(DERIVED) Top 3 from Activity DB"
              items:
                $ref: '#/components/schemas/ActivityResponse'
            recentSubmission:
              type: array
              description: "(DERIVED) Top 5 from Activity DB (challenge_created or idea_created)"
              items:
                $ref: '#/components/schemas/ActivityResponse'
            contributionGraph:
              type: object
              description: "(DERIVED) Activity group by month for 6 months. Map of month (string) to count (long)"
              additionalProperties:
                type: integer
                format: int64
            commentCount:
              type: integer
              description: "(DERIVED) Total comments"
            challengeCount:
              type: integer
              description: "(DERIVED) Total challenges"
            totalIdeaCount:
              type: integer
              description: "(DERIVED) Total ideas"

    ChallengeResponse:
      allOf:
        - $ref: '#/components/schemas/ChallengeBase'
        - type: object
          properties:
            _id:
              type: string
            createdAt:
              type: string
              format: date-time
            updatedAt:
              type: string
              format: date-time
            countOfIdeas:
              type: integer
              description: "(DERIVED) Total active ideas linked"
            ownerDetails:
              $ref: '#/components/schemas/UserMinimal'
            contributorsDetails:
              type: array
              items:
                $ref: '#/components/schemas/UserMinimal'
              description: "(DERIVED) Populated contributors users details"
            contributorsCount:
              type: integer
              description: "(DERIVED) Count of contributorsDetails array"
            commentCount:
              type: integer
              description: "(DERIVED) Calculated from Comments table"
            ideaList:
              type: array
              items:
                $ref: '#/components/schemas/IdeaMinimal'
              description: "(DERIVED) Full list from Idea collection"
            comments:
              type: array
              items:
                $ref: '#/components/schemas/CommentMinimal'
              description: "(DERIVED) Full list from Comment collection"
            contributors:
              type: array
              items:
                $ref: '#/components/schemas/UserMinimal'
              description: "(DERIVED) Owner details of all ideas under challenge"
            upvoteCount:
              type: integer
              description: "(DERIVED) Count of upVotes array"
            totalViews:
              type: integer
              description: "(DERIVED) Alias or direct mapped from viewCount field"
            upvoteList:
              type: array
              items:
                type: string
              description: "(DERIVED) Alias or direct mapped from upVotes field"

    IdeaResponse:
      allOf:
        - $ref: '#/components/schemas/IdeaBase'
        - type: object
          properties:
            _id:
              type: string
            createdAt:
              type: string
              format: date-time
            updatedAt:
              type: string
              format: date-time
            challengeDetails:
              $ref: '#/components/schemas/ChallengeMinimal'
            problemStatement:
              type: string
              description: "(DERIVED) The description from the parent Challenge"
            commentCount:
              type: integer
              description: "(DERIVED) Count calculated from Comments DB"
            comments:
              type: array
              items:
                $ref: '#/components/schemas/CommentMinimal'
              description: "(DERIVED) Populated list of comments"
            ownerDetails:
              $ref: '#/components/schemas/UserMinimal'
            upvoteCount:
              type: integer
              description: "(DERIVED) Alias for appreciationCount (number of upvotes)"
            viewCount:
              type: integer
              description: "(DERIVED) From DB viewCount field"

    CommentResponse:
      allOf:
        - $ref: '#/components/schemas/CommentBase'
        - type: object
          properties:
            _id:
              type: string
            userDetails:
              $ref: '#/components/schemas/UserMinimal'

    ActivityResponse:
      allOf:
        - $ref: '#/components/schemas/ActivityBase'
        - type: object
          properties:
            _id:
              type: string
            userDetails:
              $ref: '#/components/schemas/UserMinimal'
            entityDetails:
              type: object
              oneOf:
                - $ref: '#/components/schemas/ChallengeMinimal'
                - $ref: '#/components/schemas/IdeaMinimal'
              description: "(DERIVED) What was acted upon (Challenge or Idea)"
            activitySummary:
              type: string
              description: "(DERIVED) Human readable string generated dynamically"

    NotificationResponse:
      allOf:
        - $ref: '#/components/schemas/NotificationBase'
        - type: object
          properties:
            _id:
              type: string
            description:
              type: string
              description: "(DERIVED) Dynamically generated based on Type and initiator"
            linkedEntityDetails:
              type: object
              properties:
                virtualId:
                  type: string
                  description: CH-XXX or ID-XXXX format
                type:
                  type: string
                  enum: [CH, ID]
                challengeVirtualId:
                  type: string
                  description: Parent challenge ID (CH-XXX), required for Ideas
              description: "(DERIVED) Routing payload for frontend redirection fetched via fk_id"
            recipientDetails:
              $ref: '#/components/schemas/UserMinimal'
            initiatorDetails:
              $ref: '#/components/schemas/UserMinimal'

    AuthLoginRequest:
      type: object
      required: [email, password]
      properties:
        email:
          type: string
          format: email
        password:
          type: string
